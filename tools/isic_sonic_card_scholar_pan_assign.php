<?php
require_once("../class/config.php");
require_once(SITE_PATH . "/class/common.php");

$old_error_handler = set_error_handler("userErrorHandler");
hokusPokus();

require_once(SITE_PATH . "/class/".DB_TYPE.".class.php");
require_once(SITE_PATH . "/class/language.class.php");
require_once(SITE_PATH . "/class/text.class.php");
require_once(SITE_PATH . "/class/templatef.class.php");
require_once(SITE_PATH . "/class/Database.php");
require_once(SITE_PATH . "/class/admin.session.class.php");
require_once(SITE_PATH . "/class/IsicDB.php");

// ##############################################################
// init main variables

$db = new db;
$db->connect();
$sq = new sql;
$sq2 = new sql;

$sq->con = $db->con;
$database = new Database($sq);
$GLOBALS['database'] =& $database;
load_site_settings($database);
$data = $data_settings = $site_settings;

// init language object
$lan = new Language($database, '');
$language = $lan->lan();
$GLOBALS["language"] = &$language;

/** @var IsicDB_Cards $dbCards */
$dbCards = IsicDB::factory('Cards');

$cardList = array(
    'S372903347257Q' => '9233733180130000021',
    'S372903347258J' => '9233733180130000039',
    'S372903347259A' => '9233733180130000047',
    'S372903347260H' => '9233733180130000054',
    'S372903347261K' => '9233733180130000062',
    'S372903347262M' => '9233733180130000070',
    'S372903347263N' => '9233733180130000088',
    'S372903347264P' => '9233733180130000096',
    'S372903347265R' => '9233733180130000104',
    'S372903347266J' => '9233733180130000112',
    'S372903347267K' => '9233733180130000120',
    'S372903347268B' => '9233733180130000138',
    'S372903347269N' => '9233733180130000146',
    'S372903347270M' => '9233733180130000153',
    'S372903347271N' => '9233733180130000161',
    'S372903347272Q' => '9233733180130000179',
    'S372903347273S' => '9233733180130000187',
    'S372903347274A' => '9233733180130000195',
    'S372903347275L' => '9233733180130000203',
    'S372903347276N' => '9233733180130000211',
    'S372903347277E' => '9233733180130000229',
    'S372903347278R' => '9233733180130000237',
    'S372903347279J' => '9233733180130000245',
    'S372903347280R' => '9233733180130000252',
    'S372903347281T' => '9233733180130000260',
    'S372903347282L' => '9233733180130000278',
    'S372903347283B' => '9233733180130000286',
    'S372903347284N' => '9233733180130000294',
    'S372903347285G' => '9233733180130000302',
    'S372903347286H' => '9233733180130000310',
    'S372903347287K' => '9233733180130000328',
    'S372903347288L' => '9233733180130000336',
    'S372903347289N' => '9233733180130000344',
    'S372903347290M' => '9233733180130000351',
    'S372903347291D' => '9233733180130000369',
    'S372903347292E' => '9233733180130000377',
    'S372903347293R' => '9233733180130000385',
    'S372903347294J' => '9233733180130000393',
    'S372903347295K' => '9233733180130000401',
    'S372903347296M' => '9233733180130000419',
    'S372903347297N' => '9233733180130000427',
    'S372903347298Q' => '9233733180130000435',
    'S372903347299S' => '9233733180130000443',
    'S372903347300K' => '9233733180130000450',
    'S372903347301M' => '9233733180130000468',
    'S372903347302P' => '9233733180130000476',
    'S372903347303Q' => '9233733180130000484',
    'S372903347304J' => '9233733180130000492',
    'S372903347305A' => '9233733180130000500',
    'S372903347306L' => '9233733180130000518',
    'S372903347307N' => '9233733180130000526',
    'S372903347308E' => '9233733180130000534',
    'S372903347309R' => '9233733180130000542',
    'S372903347310P' => '9233733180130000559',
    'S372903347311R' => '9233733180130000567',
    'S372903347312J' => '9233733180130000575',
    'S372903347313K' => '9233733180130000583',
    'S372903347314B' => '9233733180130000591',
    'S372903347315N' => '9233733180130000609',
    'S372903347316Q' => '9233733180130000617',
    'S372903347317H' => '9233733180130000625',
    'S372903347318K' => '9233733180130000633',
    'S372903347319M' => '9233733180130000641',
    'S372903347320A' => '9233733180130000658',
    'S372903347321L' => '9233733180130000666',
    'S372903347322N' => '9233733180130000674',
    'S372903347323E' => '9233733180130000682',
    'S372903347324R' => '9233733180130000690',
    'S372903347325J' => '9233733180130000708',
    'S372903347326K' => '9233733180130000716',
    'S372903347327M' => '9233733180130000724',
    'S372903347328N' => '9233733180130000732',
    'S372903347329Q' => '9233733180130000740',
    'S372903347330N' => '9233733180130000757',
    'S372903347331G' => '9233733180130000765',
    'S372903347332H' => '9233733180130000773',
    'S372903347333K' => '9233733180130000781',
    'S372903347334L' => '9233733180130000799',
    'S372903347335N' => '9233733180130000807',
    'S372903347336P' => '9233733180130000815',
    'S372903347337R' => '9233733180130000823',
    'S372903347338T' => '9233733180130000831',
    'S372903347339L' => '9233733180130000849',
    'S372903347340J' => '9233733180130000856',
    'S372903347341K' => '9233733180130000864',
    'S372903347342M' => '9233733180130000872',
    'S372903347343N' => '9233733180130000880',
    'S372903347344Q' => '9233733180130000898',
    'S372903347345S' => '9233733180130000906',
    'S372903347346K' => '9233733180130000914',
    'S372903347347M' => '9233733180130000922',
    'S372903347348D' => '9233733180130000930',
    'S372903347349E' => '9233733180130000948',
    'S372903347350N' => '9233733180130000955',
    'S372903347351P' => '9233733180130000963',
    'S372903347352R' => '9233733180130000971',
    'S372903347353T' => '9233733180130000989',
    'S372903347354L' => '9233733180130000997',
    'S372903347355C' => '9233733180130001003',
    'S372903347356N' => '9233733180130001011',
    'S372903347357F' => '9233733180130001029',
    'S372903347371P' => '9233733180130001169',
    'S372903347372F' => '9233733180130001177',
    'S372903347370M' => '9233733180130001151',
    'S372903347358H' => '9233733180130001037',
    'S372903347359K' => '9233733180130001045',
    'S372903347360J' => '9233733180130001052',
    'S372903347361K' => '9233733180130001060',
    'S372903347362W' => '9233733180130001078',
    'S372903347363D' => '9233733180130001086',
    'S372903347364E' => '9233733180130001094',
    'S372903347365R' => '9233733180130001102',
    'S372903347366J' => '9233733180130001110',
    'S372903347367K' => '9233733180130001128',
    'S372903347368M' => '9233733180130001136',
    'S372903347369N' => '9233733180130001144',
    'S372903347373H' => '9233733180130001185',
    'S372903347374K' => '9233733180130001193',
    'S372903347375L' => '9233733180130001201',
    'S372903347376N' => '9233733180130001219',
    'S372903347377F' => '9233733180130001227',
    'S372903347378R' => '9233733180130001235',
    'S372903347379T' => '9233733180130001243',
    'S372903347380R' => '9233733180130001250',
    'S372903347381J' => '9233733180130001268',
    'S372903347382K' => '9233733180130001276',
    'S372903347383C' => '9233733180130001284',
    'S372903347384N' => '9233733180130001292',
    'S372903347385Q' => '9233733180130001300',
    'S372903347386H' => '9233733180130001318',
    'S372903347387K' => '9233733180130001326',
    'S372903347388W' => '9233733180130001334',
    'S372903347389N' => '9233733180130001342',
    'S372903347390L' => '9233733180130001359',
    'S372903347391N' => '9233733180130001367',
    'S372903347392E' => '9233733180130001375',
    'S372903347393R' => '9233733180130001383',
    'S372903347394T' => '9233733180130001391',
    'S372903347395K' => '9233733180130001409',
    'S372903347396M' => '9233733180130001417',
    'S372903347397Z' => '9233733180130001425',
    'S372903347398G' => '9233733180130001433',
    'S372903347399H' => '9233733180130001441',
    'S372903347400L' => '9233733180130001458',
    'S372903347401C' => '9233733180130001466',
    'S372903347402N' => '9233733180130001474',
    'S372903347403F' => '9233733180130001482',
    'S372903347404H' => '9233733180130001490',
    'S372903347405K' => '9233733180130001508',
    'S372903347406L' => '9233733180130001516',
    'S372903347407N' => '9233733180130001524',
    'S372903347408P' => '9233733180130001532',
    'S372903347409R' => '9233733180130001540',
    'S372903347410E' => '9233733180130001557',
    'S372903347411R' => '9233733180130001565',
    'S372903347412J' => '9233733180130001573',
    'S372903347413K' => '9233733180130001581',
    'S372903347414M' => '9233733180130001599',
    'S372903347415N' => '9233733180130001607',
    'S372903347416Q' => '9233733180130001615',
    'S372903347417J' => '9233733180130001623',
    'S372903347418K' => '9233733180130001631',
    'S372903347419W' => '9233733180130001649',
    'S372903347420K' => '9233733180130001656',
    'S372903347421L' => '9233733180130001664',
    'S372903347422N' => '9233733180130001672',
    'S372903347423F' => '9233733180130001680',
    'S372903347424R' => '9233733180130001698',
    'S372903347425T' => '9233733180130001706',
    'S372903347426K' => '9233733180130001714',
    'S372903347427M' => '9233733180130001722',
    'S372903347428P' => '9233733180130001730',
    'S372903347429F' => '9233733180130001748',
    'S372903347430N' => '9233733180130001755',
    'S372903347431Q' => '9233733180130001763',
    'S372903347432H' => '9233733180130001771',
    'S372903347433K' => '9233733180130001789',
    'S372903347434W' => '9233733180130001797',
    'S372903347435N' => '9233733180130001805',
    'S372903347436F' => '9233733180130001813',
    'S372903347437R' => '9233733180130001821',
    'S372903347438J' => '9233733180130001839',
    'S372903347439K' => '9233733180130001847',
    'S372903347440T' => '9233733180130001854',
    'S372903347441K' => '9233733180130001862',
    'S372903347442M' => '9233733180130001870',
    'S372903347443Z' => '9233733180130001888',
    'S372903347444G' => '9233733180130001896',
    'S372903347445H' => '9233733180130001904',
    'S372903347446A' => '9233733180130001912',
    'S372903347447L' => '9233733180130001920',
    'S372903347448N' => '9233733180130001938',
    'S372903347449E' => '9233733180130001946',
    'S372903347450N' => '9233733180130001953',
    'S372903347451P' => '9233733180130001961',
    'S372903347452J' => '9233733180130001979',
    'S372903347453J' => '9233733180130001987',
    'S372903347454K' => '9233733180130001995',
    'S372903347455B' => '9233733180130002001',
    'S372903347456N' => '9233733180130002019',
    'S372903347457Q' => '9233733180130002027',
    'S372903347458H' => '9233733180130002035',
    'S372903347459K' => '9233733180130002043',
    'S372903347460J' => '9233733180130002050',
    'S372903347461A' => '9233733180130002068',
    'S372903347462L' => '9233733180130002076',
    'S372903347463N' => '9233733180130002084',
    'S372903347464E' => '9233733180130002092',
    'S372903347465R' => '9233733180130002100',
    'S372903347466T' => '9233733180130002118',
    'S372903347467K' => '9233733180130002126',
    'S372903347468M' => '9233733180130002134',
    'S372903347469P' => '9233733180130002142',
    'S372903347470B' => '9233733180130002159',
    'S372903347471N' => '9233733180130002167',
    'S372903347472Q' => '9233733180130002175',
    'S372903347473H' => '9233733180130002183',
    'S372903347474K' => '9233733180130002191',
    'S372903347475M' => '9233733180130002209',
    'S372903347476N' => '9233733180130002217',
    'S372903347477P' => '9233733180130002225',
    'S372903347478R' => '9233733180130002233',
    'S372903347479J' => '9233733180130002241',
    'S372903347480R' => '9233733180130002258',
    'S372903347481J' => '9233733180130002266',
    'S372903347482K' => '9233733180130002274',
    'S372903347483M' => '9233733180130002282',
    'S372903347484N' => '9233733180130002290',
    'S372903347485Q' => '9233733180130002308',
    'S372903347486S' => '9233733180130002316',
    'S372903347487A' => '9233733180130002324',
    'S372903347488L' => '9233733180130002332',
    'S372903347489N' => '9233733180130002340',
    'S372903347490L' => '9233733180130002357',
    'S372903347491N' => '9233733180130002365',
    'S372903347492P' => '9233733180130002373',
    'S372903347493R' => '9233733180130002381',
    'S372903347494T' => '9233733180130002399',
    'S372903347495L' => '9233733180130002407',
    'S372903347496B' => '9233733180130002415',
    'S372903347497N' => '9233733180130002423',
    'S372903347498G' => '9233733180130002431',
    'S372903347499H' => '9233733180130002449',
    'S372903347500K' => '9233733180130002456',
    'S372903347501B' => '9233733180130002464',
    'S372903347502N' => '9233733180130002472',
    'S372903347503Q' => '9233733180130002480',
    'S372903347504H' => '9233733180130002498',
    'S372903347505K' => '9233733180130002506',
    'S372903347506W' => '9233733180130002514',
    'S372903347507N' => '9233733180130002522',
    'S372903347508P' => '9233733180130002530',
    'S372903347509J' => '9233733180130002548',
    'S372903347510E' => '9233733180130002555',
    'S372903347511R' => '9233733180130002563',
    'S372903347512T' => '9233733180130002571',
    'S372903347513K' => '9233733180130002589',
    'S372903347514M' => '9233733180130002597',
    'S372903347515P' => '9233733180130002605',
    'S372903347516Q' => '9233733180130002613',
    'S372903347517J' => '9233733180130002621',
    'S372903347518A' => '9233733180130002639',
    'S372903347519L' => '9233733180130002647',
    'S372903347520K' => '9233733180130002654',
    'S372903347521M' => '9233733180130002662',
    'S372903347522N' => '9233733180130002670',
    'S372903347523P' => '9233733180130002688',
    'S372903347524R' => '9233733180130002696',
    'S372903347525J' => '9233733180130002704',
    'S372903347526K' => '9233733180130002712',
    'S372903347527B' => '9233733180130002720',
    'S372903347528N' => '9233733180130002738',
    'S372903347529Q' => '9233733180130002746',
    'S372903347530N' => '9233733180130002753',
    'S372903347531Q' => '9233733180130002761',
    'S372903347532S' => '9233733180130002779',
    'S372903347533A' => '9233733180130002787',
    'S372903347534L' => '9233733180130002795',
    'S372903347535N' => '9233733180130002803',
    'S372903347536E' => '9233733180130002811',
    'S372903347537R' => '9233733180130002829',
    'S372903347538J' => '9233733180130002837',
    'S372903347539K' => '9233733180130002845',
    'S372903347540T' => '9233733180130002852',
    'S372903347541L' => '9233733180130002860',
    'S372903347542B' => '9233733180130002878',
    'S372903347543N' => '9233733180130002886',
    'S372903347544G' => '9233733180130002894',
    'S372903347545H' => '9233733180130002902',
    'S372903347546K' => '9233733180130002910',
    'S372903347547L' => '9233733180130002928',
    'S372903347548N' => '9233733180130002936',
    'S372903347549P' => '9233733180130002944',
    'S372903347550D' => '9233733180130002951',
    'S372903347551E' => '9233733180130002969',
    'S372903347552R' => '9233733180130002977',
    'S372903347553J' => '9233733180130002985',
    'S372903347554K' => '9233733180130002993',
    'S372903347555M' => '9233733180130003009',
    'S372903347556N' => '9233733180130003017',
    'S372903347557Q' => '9233733180130003025',
    'S372903347558S' => '9233733180130003033',
    'S372903347559K' => '9233733180130003041',
    'S372903347560H' => '9233733180130003058',
    'S372903347561K' => '9233733180130003066',
    'S372903347562L' => '9233733180130003074',
    'S372903347563N' => '9233733180130003082',
    'S372903347564P' => '9233733180130003090',
    'S372903347565R' => '9233733180130003108',
    'S372903347566T' => '9233733180130003116',
    'S372903347567L' => '9233733180130003124',
    'S372903347568C' => '9233733180130003132',
    'S372903347569N' => '9233733180130003140',
    'S372903347570M' => '9233733180130003157',
    'S372903347571N' => '9233733180130003165',
    'S372903347572Q' => '9233733180130003173',
    'S372903347573J' => '9233733180130003181',
    'S372903347574K' => '9233733180130003199',
    'S372903347575W' => '9233733180130003207',
    'S372903347576D' => '9233733180130003215',
    'S372903347577E' => '9233733180130003223',
    'S372903347578R' => '9233733180130003231',
    'S372903347579J' => '9233733180130003249',
    'S372903347580R' => '9233733180130003256',
    'S372903347581T' => '9233733180130003264',
    'S372903347582K' => '9233733180130003272',
    'S372903347583M' => '9233733180130003280',
    'S372903347584P' => '9233733180130003298',
    'S372903347585F' => '9233733180130003306',
    'S372903347586H' => '9233733180130003314',
    'S372903347587K' => '9233733180130003322',
    'S372903347588L' => '9233733180130003330',
    'S372903347589N' => '9233733180130003348',
    'S372903347590W' => '9233733180130003355',
    'S372903347591N' => '9233733180130003363',
    'S372903347592F' => '9233733180130003371',
    'S372903347593R' => '9233733180130003389',
    'S372903347594J' => '9233733180130003397',
    'S372903347595K' => '9233733180130003405',
    'S372903347596C' => '9233733180130003413',
    'S372903347597N' => '9233733180130003421',
    'S372903347598Q' => '9233733180130003439',
    'S372903347599H' => '9233733180130003447',
    'S372903347600K' => '9233733180130003454',
    'S372903347601M' => '9233733180130003462',
    'S372903347602N' => '9233733180130003470',
    'S372903347603Q' => '9233733180130003488',
    'S372903347604S' => '9233733180130003496',
    'S372903347605K' => '9233733180130003504',
    'S372903347606M' => '9233733180130003512',
    'S372903347607D' => '9233733180130003520',
    'S372903347608E' => '9233733180130003538',
    'S372903347609R' => '9233733180130003546',
    'S372903347610P' => '9233733180130003553',
    'S372903347611R' => '9233733180130003561',
    'S372903347612T' => '9233733180130003579',
    'S372903347613L' => '9233733180130003587',
    'S372903347614C' => '9233733180130003595',
    'S372903347615N' => '9233733180130003603',
    'S372903347616F' => '9233733180130003611',
    'S372903347617H' => '9233733180130003629',
    'S372903347618K' => '9233733180130003637',
    'S372903347619L' => '9233733180130003645',
    'S372903347620K' => '9233733180130003652',
    'S372903347621W' => '9233733180130003660',
    'S372903347622D' => '9233733180130003678',
    'S372903347623E' => '9233733180130003686',
    'S372903347624R' => '9233733180130003694',
    'S372903347625J' => '9233733180130003702',
    'S372903347626K' => '9233733180130003710',
    'S372903347627M' => '9233733180130003728',
    'S372903347628N' => '9233733180130003736',
    'S372903347629Q' => '9233733180130003744',
    'S372903347630P' => '9233733180130003751',
    'S372903347631F' => '9233733180130003769',
    'S372903347632H' => '9233733180130003777',
    'S372903347633K' => '9233733180130003785',
    'S372903347634L' => '9233733180130003793',
    'S372903347635N' => '9233733180130003801',
    'S372903347636F' => '9233733180130003819',
    'S372903347637R' => '9233733180130003827',
    'S372903347638T' => '9233733180130003835',
    'S372903347639K' => '9233733180130003843',
    'S372903347640J' => '9233733180130003850',
    'S372903347641K' => '9233733180130003868',
    'S372903347642C' => '9233733180130003876',
    'S372903347643N' => '9233733180130003884',
    'S372903347644Q' => '9233733180130003892',
    'S372903347645H' => '9233733180130003900',
    'S372903347646K' => '9233733180130003918',
    'S372903347647W' => '9233733180130003926',
    'S372903347648N' => '9233733180130003934',
    'S372903347649F' => '9233733180130003942',
    'S372903347650N' => '9233733180130003959',
    'S372903347651E' => '9233733180130003967',
    'S372903347652R' => '9233733180130003975',
    'S372903347653T' => '9233733180130003983',
    'S372903347654K' => '9233733180130003991',
    'S372903347655M' => '9233733180130004007',
    'S372903347656Z' => '9233733180130004015',
    'S372903347657G' => '9233733180130004023',
    'S372903347658H' => '9233733180130004031',
    'S372903347659A' => '9233733180130004049',
    'S372903347660H' => '9233733180130004056',
    'S372903347661K' => '9233733180130004064',
    'S372903347662W' => '9233733180130004072',
    'S372903347663N' => '9233733180130004080',
    'S372903347664P' => '9233733180130004098',
    'S372903347665J' => '9233733180130004106',
    'S372903347666J' => '9233733180130004114',
    'S372903347667K' => '9233733180130004122',
    'S372903347668B' => '9233733180130004130',
    'S372903347669N' => '9233733180130004148',
    'S372903347670M' => '9233733180130004155',
    'S372903347671P' => '9233733180130004163',
    'S372903347672Q' => '9233733180130004171',
    'S372903347673J' => '9233733180130004189',
    'S372903347674A' => '9233733180130004197',
    'S372903347675L' => '9233733180130004205',
    'S372903347676N' => '9233733180130004213',
    'S372903347677E' => '9233733180130004221',
    'S372903347678R' => '9233733180130004239',
    'S372903347679T' => '9233733180130004247',
    'S372903347680R' => '9233733180130004254',
    'S372903347681J' => '9233733180130004262',
    'S372903347682K' => '9233733180130004270',
    'S372903347683B' => '9233733180130004288',
    'S372903347684N' => '9233733180130004296',
    'S372903347685Q' => '9233733180130004304',
    'S372903347686H' => '9233733180130004312',
    'S372903347687K' => '9233733180130004320',
    'S372903347688M' => '9233733180130004338',
    'S372903347689N' => '9233733180130004346',
    'S372903347690L' => '9233733180130004353',
    'S372903347691N' => '9233733180130004361',
    'S372903347692E' => '9233733180130004379',
    'S372903347693R' => '9233733180130004387',
    'S372903347694J' => '9233733180130004395',
    'S372903347695K' => '9233733180130004403',
    'S372903347696M' => '9233733180130004411',
    'S372903347697N' => '9233733180130004429',
    'S372903347698Q' => '9233733180130004437',
    'S372903347699S' => '9233733180130004445',
    'S372903347700K' => '9233733180130004452',
    'S372903347701M' => '9233733180130004460',
    'S372903347702Z' => '9233733180130004478',
    'S372903347703G' => '9233733180130004486',
    'S372903347704H' => '9233733180130004494',
    'S372903347705A' => '9233733180130004502',
    'S372903347706L' => '9233733180130004510',
    'S372903347707N' => '9233733180130004528',
    'S372903347708E' => '9233733180130004536',
    'S372903347709R' => '9233733180130004544',
    'S372903347710P' => '9233733180130004551',
    'S372903347711J' => '9233733180130004569',
    'S372903347712J' => '9233733180130004577',
);

//chdir('');

foreach ($cardList as $isicNumber => $panNumber) {
//    echo $isicNumber . ": " . $panNumber;
    $cardId = $dbCards->getIdByIsicNumber($isicNumber);
    if ($cardId) {
//        $cardRecord = $dbCards->getRecord($cardId);
//        if ($cardRecord['pan_number'] != '' && $cardRecord['pan_number'] != $panNumber) {
//            echo 'Pan number mismatch: ' . $isicNumber . ', Old: ' . $cardRecord['pan_number'] . ', New: ' . $panNumber;
//            echo "\n";
//        }
        $dbCards->updateRecord($cardId, array('pan_number' => $panNumber));
    } else {
        echo 'Could not find card: ' . $isicNumber;
        echo "\n";
    }
}

echo "Done\n";